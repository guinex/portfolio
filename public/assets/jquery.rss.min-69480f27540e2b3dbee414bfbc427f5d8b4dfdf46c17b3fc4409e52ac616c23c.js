!function(r){var i=function(e,t,n,i){this.target=e,this.url=t,this.html=[],this.effectQueue=[],this.options=r.extend({ssl:!1,limit:null,key:null,layoutTemplate:"<ul>{entries}</ul>",entryTemplate:'<li><a href="{url}">[{author}@{date}] {title}</a><br/>{shortBodyPlain}</li>',tokens:{},outputMode:"json",effect:"show",error:function(){console.log("jQuery RSS: url doesn't link to RSS-Feed")},success:function(){}},n||{}),this.callback=i||this.options.success};i.htmlTags="doctype,html,head,title,base,link,meta,style,script,noscript,body,article,nav,aside,section,header,footer,h1-h6,hgroup,address,p,hr,pre,blockquote,ol,ul,li,dl,dt,dd,figure,figcaption,div,table,caption,thead,tbody,tfoot,tr,th,td,col,colgroup,form,fieldset,legend,label,input,button,select,datalist,optgroup,option,textarea,keygen,output,progress,meter,details,summary,command,menu,del,ins,img,iframe,embed,object,param,video,audio,source,canvas,track,map,area,a,em,strong,i,b,u,s,small,abbr,q,cite,dfn,sub,sup,time,code,kbd,samp,var,mark,bdi,bdo,ruby,rt,rp,span,br,wbr".split(","),i.prototype.load=function(e){var t="http"+(this.options.ssl?"s":"")+"://ajax.googleapis.com/ajax/services/feed/load?v=1.0&output="+this.options.outputMode+"&callback=?&q="+encodeURIComponent(this.url);null!=this.options.limit&&(t+="&num="+this.options.limit),null!=this.options.key&&(t+="&key="+this.options.key),r.getJSON(t,e)},i.prototype.render=function(){var n=this;this.load(function(e){try{n.feed=e.responseData.feed,n.entries=e.responseData.feed.entries}catch(t){return n.entries=[],n.feed=null,n.options.error.call(n)}e=n.generateHTMLForEntries(),n.target.append(e.layout),0!==e.entries.length&&n.appendEntriesAndApplyEffects(r("entries",e.layout),e.entries),0<n.effectQueue.length?n.executeEffectQueue(n.callback):r.isFunction(n.callback)&&n.callback.call(n)})},i.prototype.appendEntriesAndApplyEffects=function(i,e){var o=this;r.each(e,function(e,t){var n=o.wrapContent(t);"show"===o.options.effect?i.before(n):(n.css({display:"none"}),i.before(n),o.applyEffect(n,o.options.effect))}),i.remove()},i.prototype.generateHTMLForEntries=function(){var t=this,n={entries:[],layout:null};return r(this.entries).each(function(){if(t.isRelevant(this)){var e=t.evaluateStringForEntry(t.options.entryTemplate,this);n.entries.push(e)}}),n.layout=this.options.entryTemplate?this.wrapContent(this.options.layoutTemplate.replace("{entries}","<entries></entries>")):this.wrapContent("<div><entries></entries></div>"),n},i.prototype.wrapContent=function(e){return 0!==r.trim(e).indexOf("<")?r("<div>"+e+"</div>"):r(e)},i.prototype.applyEffect=function(e,t,n){switch(t){case"slide":e.slideDown("slow",n);break;case"slideFast":e.slideDown(n);break;case"slideSynced":this.effectQueue.push({element:e,effect:"slide"});break;case"slideFastSynced":this.effectQueue.push({element:e,effect:"slideFast"})}},i.prototype.executeEffectQueue=function(t){var n=this;this.effectQueue.reverse();var i=function(){var e=n.effectQueue.pop();e?n.applyEffect(e.element,e.effect,i):t&&t()};i()},i.prototype.evaluateStringForEntry=function(e,t){var n=e,i=this;return r(e.match(/(\{.*?\})/g)).each(function(){var e=this.toString();n=n.replace(e,i.getValueForToken(e,t))}),n},i.prototype.isRelevant=function(e){var t=this.getTokenMap(e);return!this.options.filter||(!this.options.filterLimit||this.options.filterLimit!=this.html.length)&&this.options.filter(e,t)},i.prototype.getTokenMap=function(e){if(!this.feedTokens){var t=JSON.parse(JSON.stringify(this.feed));delete t.entries,this.feedTokens=t}return r.extend({feed:this.feedTokens,url:e.link,author:e.author,date:e.publishedDate,title:e.title,body:e.content,shortBody:e.contentSnippet,bodyPlain:function(e){e=e.content.replace(/<script[\\r\\\s\S]*<\/script>/gim,"").replace(/<\/?[^>]+>/gi,"");for(var t=0;t<i.htmlTags.length;t++)e=e.replace(RegExp("<"+i.htmlTags[t],"gi"),"");return e}(e),shortBodyPlain:e.contentSnippet.replace(/<\/?[^>]+>/gi,""),index:r.inArray(e,this.entries),totalEntries:this.entries.length,teaserImage:function(e){try{return e.content.match(/(<img.*?>)/gi)[0]}catch(t){return""}}(e),teaserImageUrl:function(e){try{return e.content.match(/(<img.*?>)/gi)[0].match(/src="(.*?)"/)[1]}catch(t){return""}}(e)},this.options.tokens)},i.prototype.getValueForToken=function(e,t){var n,i=this.getTokenMap(t);if(void 0!==(n=i[n=e.replace(/[\{\}]/g,"")]))return"function"==typeof n?n(t,i):n;throw Error("Unknown token: "+e)},r.fn.rss=function(e,t,n){return new i(this,e,t,n).render(),this}}(jQuery);